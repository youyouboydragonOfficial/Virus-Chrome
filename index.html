<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç„¡æ–™ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨ºæ–­ | å…¬å¼</title>
    <style>
        body { font-family: sans-serif; background: #f3f3f3; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .box { background: white; width: 90%; max-width: 400px; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); text-align: center; border-top: 6px solid #0078d4; }
        .btn { background: #0078d4; color: white; border: none; padding: 15px; width: 100%; font-weight: bold; cursor: pointer; border-radius: 4px; font-size: 16px; transition: background 0.3s; }
        .btn:hover { background: #005a9e; }
    </style>
</head>
<body>
<div class="box">
    <h1 style="color:#333; font-size:20px;">ğŸ›¡ï¸ ã‚·ã‚¹ãƒ†ãƒ æ•´åˆæ€§ã‚¹ã‚­ãƒ£ãƒ³</h1>
    <p style="color:#666; font-size:14px;">ãƒ‡ãƒã‚¤ã‚¹ã®å®‰å…¨æ€§ã‚’ç¢ºèªã—ã¾ã™ã€‚ã‚¹ã‚­ãƒ£ãƒ³ã‚’é–‹å§‹ã™ã‚‹ã«ã¯ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
    <button class="btn" onclick="start()">ã‚¹ã‚­ãƒ£ãƒ³ã‚’é–‹å§‹ã™ã‚‹</button>
</div>

<script>
    async function start() {
        const permission = await Notification.requestPermission();
        if (permission === "granted") {
            alert("è¨ºæ–­ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚ã“ã®ã‚¿ãƒ–ã‚’é–‰ã˜ã¦ã‚‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ç¶™ç¶šã•ã‚Œã¾ã™ã€‚");

            // ãƒ‡ãƒã‚¤ã‚¹åˆ¤å®š
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

            if (isMobile) {
                // ã‚¹ãƒãƒ›ãƒ»iPadç”¨ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ã„ã¦ã„ã‚‹é–“ã ã‘å‹•ä½œï¼‰
                sendNotice();
            } else {
                // PCç”¨ï¼ˆService Workerã‚’ç™»éŒ²ã—ã¦æ°¸ç¶šåŒ–ï¼‰
                const reg = await navigator.serviceWorker.register('sw.js');
                // ç™»éŒ²å®Œäº†ã¾ã§å¾…ã£ã¦ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
                navigator.serviceWorker.ready.then((registration) => {
                    registration.active.postMessage('start');
                });
            }
        } else {
            alert("ã‚¨ãƒ©ãƒ¼: æ•´åˆæ€§ã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯é€šçŸ¥ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚");
        }
    }

    // ã‚¹ãƒãƒ›ãƒ»iPadç”¨ã®å†å¸°é–¢æ•°
    function sendNotice() {
        const isIcon = Math.random() > 0.5;
        const n = new Notification(isIcon ? "âš  Microsoftè­¦å‘Š" : "SYSTEM ERROR", {
            body: isIcon ? "ã‚¦ã‚¤ãƒ«ã‚¹ã‚’æ¤œå‡ºã—ã¾ã—ãŸï¼ç›´ã¡ã«é§†é™¤ãŒå¿…è¦ã§ã™ã€‚" : "ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ç ´æ: 0x800410",
            icon: "https://img.icons8.com/color/96/microsoft.png"
        });

        // ã‚¯ãƒªãƒƒã‚¯æ™‚ã¯ä½•ã‚‚ã—ãªã„
        n.onclick = () => { n.close(); };

        // é–‰ã˜ã‚‰ã‚ŒãŸæ™‚ï¼ˆã‚¹ãƒ¯ã‚¤ãƒ—ã‚„Ã—ãƒœã‚¿ãƒ³ï¼‰ã ã‘ã€0.3ç§’å¾Œã«æ¬¡ã‚’å‡ºã™
        n.onclose = () => {
            setTimeout(sendNotice, 300);
        };
    }
</script>
</body>
</html>
